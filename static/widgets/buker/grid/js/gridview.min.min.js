(function(h){var i,f,j={},g=[];i=function(c){var b=g[c],a=h("#"+c).find("."+b.tableClass);a.children("tbody").find("input.select-on-check").filter(":checked").each(function(){h(this).closest("tr").addClass("selected")});a.children("thead").find("th input").filter('[type="checkbox"]').each(function(){var e=this.name.substring(0,this.name.length-4)+"[]",d=h("input[name='"+e+"']",a);this.checked=d.length>0&&d.length===d.filter(":checked").length});return this};f={init:function(b){var a=h.extend({ajaxUpdate:[],ajaxVar:"ajax",ajaxType:"GET",pagerClass:"pager",loadingClass:"loading",filterClass:"filters",tableClass:"items",selectableRows:1},b||{});a.tableClass=a.tableClass.replace(/\s+/g,".");return this.each(function(){var n,o=h(this),c=o.attr("id"),e="#"+c+" ."+a.pagerClass.replace(/\s+/g,".")+" a",p="#"+c+" ."+a.tableClass+" thead th a.sort-link",d="#"+c+" ."+a.filterClass+" input, #"+c+" ."+a.filterClass+" select";a.updateSelector=a.updateSelector.replace("{page}",e).replace("{sort}",p);a.filterSelector=a.filterSelector.replace("{filter}",d);g[c]=a;if(a.ajaxUpdate.length>0){h(document).on("click.yiiGridView",a.updateSelector,function(){if(a.enableHistory&&window.History.enabled){var l=h(this).attr("href").split("?"),k=h.deparam.querystring("?"+(l[1]||""));delete k[a.ajaxVar];window.History.pushState(null,document.title,decodeURIComponent(h.param.querystring(l[0],k)))}else{h("#"+c).yiiGridView("update",{url:h(this).attr("href")})}return false})}h(document).on("change.yiiGridView keydown.yiiGridView",a.filterSelector,function(m){if(m.type==="keydown"){if(m.keyCode!==13){return}else{n="keydown"}}else{if(n==="keydown"){n="";return}}var l=h(a.filterSelector).serialize();if(a.pageVar!==undefined){l+="&"+a.pageVar+"=1"}if(a.enableHistory&&a.ajaxUpdate!==false&&window.History.enabled){var r=h("#"+c).yiiGridView("getUrl"),k=h.deparam.querystring(h.param.querystring(r,l));delete k[a.ajaxVar];window.History.pushState(null,document.title,decodeURIComponent(h.param.querystring(r.substr(0,r.indexOf("?")),k)))}else{h("#"+c).yiiGridView("update",{data:l})}return false});if(a.enableHistory&&a.ajaxUpdate!==false&&window.History.enabled){h(window).bind("statechange",function(){var k=window.History.getState();h("#"+c).yiiGridView("update",{url:k.url})})}if(a.selectableRows>0){i(this.id);h(document).on("click.yiiGridView","#"+c+" ."+a.tableClass+' > tbody > tr input[type="checkbox"]',function(k){var l,u,m,t,v=h(k.target);if(v.closest("td").is(".empty,.button-column")||(k.target.type==="checkbox"&&!v.hasClass("select-on-check"))){return}u=h(this);l=h("#"+c);t=h("input.select-on-check",l);m=u.toggleClass("selected").hasClass("selected");if(a.selectableRows===1){u.siblings().removeClass("selected");t.prop("checked",false)}h("input.select-on-check",u).prop("checked",m);h("input.select-on-check-all",l).prop("checked",t.length===t.filter(":checked").length);if(a.selectionChanged!==undefined){a.selectionChanged(c)}});if(a.selectableRows>1){h(document).on("click.yiiGridView","#"+c+" .select-on-check-all",function(){var k=h("#"+c),l=h("input.select-on-check",k),r=h("input.select-on-check-all",k),m=k.find("."+a.tableClass).children("tbody").children();if(this.checked){m.addClass("selected");l.prop("checked",true);r.prop("checked",true)}else{m.removeClass("selected");l.prop("checked",false);r.prop("checked",false)}if(a.selectionChanged!==undefined){a.selectionChanged(c)}})}}else{h(document).on("click.yiiGridView","#"+c+" .select-on-check",false)}})},getKey:function(a){return this.children(".keys").children("span").eq(a).text()},getUrl:function(){var a=g[this.attr("id")].url;return a||this.children(".keys").attr("title")},getRow:function(b){var a=g[this.attr("id")].tableClass;return this.find("."+a).children("tbody").children("tr").eq(b).children()},getColumn:function(b){var a=g[this.attr("id")].tableClass;return this.find("."+a).children("tbody").children("tr").children("td:nth-child("+(b+1)+")")},update:function(a){var b;if(a&&a.error!==undefined){b=a.error;delete a.error}return this.each(function(){var e,l=h(this),c=l.attr("id"),d=g[c];a=h.extend({type:d.ajaxType,url:l.yiiGridView("getUrl"),success:function(k){var n=h("<div>"+k+"</div>");h.each(d.ajaxUpdate,function(r,m){var q="#"+m;h(q).replaceWith(h(q,n))});if(d.afterAjaxUpdate!==undefined){d.afterAjaxUpdate(c,k)}if(d.selectableRows>0){i(c)}$ajax.checkResponse(k)},complete:function(){j[c]=null;l.removeClass(d.loadingClass)},error:function(t,r,s){var q,k;if(t.readyState===0||t.status===0){return}if(b!==undefined){q=b(t);if(q!==undefined&&!q){return}}switch(r){case"timeout":k="The request timed out!";break;case"parsererror":k="Parser error!";break;case"error":if(t.status&&!/^\s*$/.test(t.status)){k="Error "+t.status}else{k="Error"}if(t.responseText&&!/^\s*$/.test(t.responseText)){k=k+": "+t.responseText}break}if(d.ajaxUpdateError!==undefined){d.ajaxUpdateError(t,r,s,k)}else{if(k){alert(k)}}}},a||{});if(a.type==="GET"){if(a.data!==undefined){a.url=h.param.querystring(a.url,a.data);a.data={}}}else{if(a.data===undefined){a.data=h(d.filterSelector).serialize()}}if(j[c]!=null){j[c].abort()}l.addClass(d.loadingClass);if(d.ajaxUpdate!==false){if(d.ajaxVar){a.url=h.param.querystring(a.url,d.ajaxVar+"="+c)}if(d.beforeAjaxUpdate!==undefined){d.beforeAjaxUpdate(c,a)}j[c]=h.ajax(a)}else{if(a.type==="GET"){window.location.href=a.url}else{e=h('<form action="'+a.url+'" method="post"></form>').appendTo("body");if(a.data===undefined){a.data={}}if(a.data.returnUrl===undefined){a.data.returnUrl=window.location.href}h.each(a.data,function(n,k){e.append(h('<input type="hidden" name="t" value="" />').attr("name",n).val(k))});e.submit()}}})},getSelection:function(){var b=g[this.attr("id")],a=this.find(".keys span"),c=[];this.find("."+b.tableClass).children("tbody").children().each(function(d){if(h(this).hasClass("selected")){c.push(a.eq(d).text())}});return c},getChecked:function(d){var c=g[this.attr("id")],a=this.find(".keys span"),b=[];if(d.substring(d.length-2)!=="[]"){d=d+"[]"}this.find("."+c.tableClass).children("tbody").children("tr").children("td").children('input[name="'+d+'"]').each(function(e){if(this.checked){b.push(a.eq(e).text())}});return b}};h.fn.yiiGridView=function(a){if(f[a]){return f[a].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof a==="object"||!a){return f.init.apply(this,arguments)}else{h.error("Method "+a+" does not exist on jQuery.yiiGridView");return false}}};h.fn.yiiGridView.settings=g;h.fn.yiiGridView.getKey=function(a,b){return h("#"+a).yiiGridView("getKey",b)};h.fn.yiiGridView.getUrl=function(a){return h("#"+a).yiiGridView("getUrl")};h.fn.yiiGridView.getRow=function(a,b){return h("#"+a).yiiGridView("getRow",b)};h.fn.yiiGridView.getColumn=function(a,b){return h("#"+a).yiiGridView("getColumn",b)};h.fn.yiiGridView.update=function(a,b){h("#"+a).yiiGridView("update",b)};h.fn.yiiGridView.getSelection=function(a){return h("#"+a).yiiGridView("getSelection")};h.fn.yiiGridView.getChecked=function(a,b){return h("#"+a).yiiGridView("getChecked",b)}})(jQuery);