(function(c){var b,e,a={},d=[];b=function(h){var f=d[h],g=c("#"+h).find("."+f.tableClass);g.children("tbody").find("input.select-on-check").filter(":checked").each(function(){c(this).closest("tr").addClass("selected")});g.children("thead").find("th input").filter('[type="checkbox"]').each(function(){var i=this.name.substring(0,this.name.length-4)+"[]",j=c("input[name='"+i+"']",g);this.checked=j.length>0&&j.length===j.filter(":checked").length});return this};e={init:function(f){var g=c.extend({ajaxUpdate:[],ajaxVar:"ajax",ajaxType:"GET",pagerClass:"pager",loadingClass:"loading",filterClass:"filters",tableClass:"items",selectableRows:1},f||{});g.tableClass=g.tableClass.replace(/\s+/g,".");return this.each(function(){var m,k=c(this),l=k.attr("id"),i="#"+l+" ."+g.pagerClass.replace(/\s+/g,".")+" a",h="#"+l+" ."+g.tableClass+" thead th a.sort-link",j="#"+l+" ."+g.filterClass+" input, #"+l+" ."+g.filterClass+" select";g.updateSelector=g.updateSelector.replace("{page}",i).replace("{sort}",h);g.filterSelector=g.filterSelector.replace("{filter}",j);d[l]=g;if(g.ajaxUpdate.length>0){c(document).on("click.yiiGridView",g.updateSelector,function(){if(g.enableHistory&&window.History.enabled){var n=c(this).attr("href").split("?"),o=c.deparam.querystring("?"+(n[1]||""));delete o[g.ajaxVar];window.History.pushState(null,document.title,decodeURIComponent(c.param.querystring(n[0],o)))}else{c("#"+l).yiiGridView("update",{url:c(this).attr("href")})}return false})}c(document).on("change.yiiGridView keydown.yiiGridView",g.filterSelector,function(n){if(n.type==="keydown"){if(n.keyCode!==13){return}else{m="keydown"}}else{if(m==="keydown"){m="";return}}var o=c(g.filterSelector).serialize();if(g.pageVar!==undefined){o+="&"+g.pageVar+"=1"}if(g.enableHistory&&g.ajaxUpdate!==false&&window.History.enabled){var q=c("#"+l).yiiGridView("getUrl"),p=c.deparam.querystring(c.param.querystring(q,o));delete p[g.ajaxVar];window.History.pushState(null,document.title,decodeURIComponent(c.param.querystring(q.substr(0,q.indexOf("?")),p)))}else{c("#"+l).yiiGridView("update",{data:o})}return false});if(g.enableHistory&&g.ajaxUpdate!==false&&window.History.enabled){c(window).bind("statechange",function(){var n=window.History.getState();c("#"+l).yiiGridView("update",{url:n.url})})}if(g.selectableRows>0){b(this.id);c(document).on("click.yiiGridView","#"+l+" ."+g.tableClass+' > tbody > tr input[type="checkbox"]',function(q){var o,r,n,s,p=c(q.target);if(p.closest("td").is(".empty,.button-column")||(q.target.type==="checkbox"&&!p.hasClass("select-on-check"))){return}r=c(this);o=c("#"+l);s=c("input.select-on-check",o);n=r.toggleClass("selected").hasClass("selected");if(g.selectableRows===1){r.siblings().removeClass("selected");s.prop("checked",false)}c("input.select-on-check",r).prop("checked",n);c("input.select-on-check-all",o).prop("checked",s.length===s.filter(":checked").length);if(g.selectionChanged!==undefined){g.selectionChanged(l)}});if(g.selectableRows>1){c(document).on("click.yiiGridView","#"+l+" .select-on-check-all",function(){var p=c("#"+l),o=c("input.select-on-check",p),q=c("input.select-on-check-all",p),n=p.find("."+g.tableClass).children("tbody").children();if(this.checked){n.addClass("selected");o.prop("checked",true);q.prop("checked",true)}else{n.removeClass("selected");o.prop("checked",false);q.prop("checked",false)}if(g.selectionChanged!==undefined){g.selectionChanged(l)}})}}else{c(document).on("click.yiiGridView","#"+l+" .select-on-check",false)}})},getKey:function(f){return this.children(".keys").children("span").eq(f).text()},getUrl:function(){var f=d[this.attr("id")].url;return f||this.children(".keys").attr("title")},getRow:function(f){var g=d[this.attr("id")].tableClass;return this.find("."+g).children("tbody").children("tr").eq(f).children()},getColumn:function(f){var g=d[this.attr("id")].tableClass;return this.find("."+g).children("tbody").children("tr").children("td:nth-child("+(f+1)+")")},update:function(g){var f;if(g&&g.error!==undefined){f=g.error;delete g.error}return this.each(function(){var i,h=c(this),k=h.attr("id"),j=d[k];g=c.extend({type:j.ajaxType,url:h.yiiGridView("getUrl"),success:function(l){var m=c("<div>"+l+"</div>");c.each(j.ajaxUpdate,function(o,n){var p="#"+n;c(p).replaceWith(c(p,m))});if(j.afterAjaxUpdate!==undefined){j.afterAjaxUpdate(k,l)}if(j.selectableRows>0){b(k)}$ajax.checkResponse(l)},complete:function(){a[k]=null;h.removeClass(j.loadingClass)},error:function(m,o,n){var p,l;if(m.readyState===0||m.status===0){return}if(f!==undefined){p=f(m);if(p!==undefined&&!p){return}}switch(o){case"timeout":l="The request timed out!";break;case"parsererror":l="Parser error!";break;case"error":if(m.status&&!/^\s*$/.test(m.status)){l="Error "+m.status}else{l="Error"}if(m.responseText&&!/^\s*$/.test(m.responseText)){l=l+": "+m.responseText}break}if(j.ajaxUpdateError!==undefined){j.ajaxUpdateError(m,o,n,l)}else{if(l){alert(l)}}}},g||{});if(g.type==="GET"){if(g.data!==undefined){g.url=c.param.querystring(g.url,g.data);g.data={}}}else{if(g.data===undefined){g.data=c(j.filterSelector).serialize()}}if(a[k]!=null){a[k].abort()}h.addClass(j.loadingClass);if(j.ajaxUpdate!==false){if(j.ajaxVar){g.url=c.param.querystring(g.url,j.ajaxVar+"="+k)}if(j.beforeAjaxUpdate!==undefined){j.beforeAjaxUpdate(k,g)}a[k]=c.ajax(g)}else{if(g.type==="GET"){window.location.href=g.url}else{i=c('<form action="'+g.url+'" method="post"></form>').appendTo("body");if(g.data===undefined){g.data={}}if(g.data.returnUrl===undefined){g.data.returnUrl=window.location.href}c.each(g.data,function(m,l){i.append(c('<input type="hidden" name="t" value="" />').attr("name",m).val(l))});i.submit()}}})},getSelection:function(){var f=d[this.attr("id")],g=this.find(".keys span"),h=[];this.find("."+f.tableClass).children("tbody").children().each(function(i){if(c(this).hasClass("selected")){h.push(g.eq(i).text())}});return h},getChecked:function(h){var i=d[this.attr("id")],g=this.find(".keys span"),f=[];if(h.substring(h.length-2)!=="[]"){h=h+"[]"}this.find("."+i.tableClass).children("tbody").children("tr").children("td").children('input[name="'+h+'"]').each(function(j){if(this.checked){f.push(g.eq(j).text())}});return f}};c.fn.yiiGridView=function(f){if(e[f]){return e[f].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof f==="object"||!f){return e.init.apply(this,arguments)}else{c.error("Method "+f+" does not exist on jQuery.yiiGridView");return false}}};c.fn.yiiGridView.settings=d;c.fn.yiiGridView.getKey=function(g,f){return c("#"+g).yiiGridView("getKey",f)};c.fn.yiiGridView.getUrl=function(f){return c("#"+f).yiiGridView("getUrl")};c.fn.yiiGridView.getRow=function(g,f){return c("#"+g).yiiGridView("getRow",f)};c.fn.yiiGridView.getColumn=function(g,f){return c("#"+g).yiiGridView("getColumn",f)};c.fn.yiiGridView.update=function(g,f){c("#"+g).yiiGridView("update",f)};c.fn.yiiGridView.getSelection=function(f){return c("#"+f).yiiGridView("getSelection")};c.fn.yiiGridView.getChecked=function(g,f){return c("#"+g).yiiGridView("getChecked",f)}})(jQuery);